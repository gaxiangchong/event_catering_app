{% extends "base.html" %}

{% block content %}
<div class="result-wrapper">
    {% if order.status.value == 'paid' %}
    <div class="success-icon">✅</div>
    <h2>Payment Successful!</h2>
    <p>Your booking is confirmed.</p>

    <div class="receipt-card">
        <p><strong>Order Ref:</strong> {{ order.payment_reference }}</p>
        <p><strong>Event:</strong> {{ order.event.title }}</p>
        <p><strong>Meal:</strong> {{ order.meal_option.name }}</p>
        <p><strong>Amount:</strong> RM{{ "%.2f"|format(order.amount + order.admin_fee) }}</p>
    </div>

    <a href="{{ url_for('events.list_events') }}" class="btn-primary">Back to Events</a>

    {% elif order.status.value == 'processing' %}
    <div class="processing-icon">⏳</div>
    <h2>Payment Processing</h2>
    <p>Your Touch n Go payment is being verified by our admin team. You will be notified once approved.</p>

    <div class="receipt-card">
        <p><strong>Order ID:</strong> #{{ order.id }}</p>
        <p><strong>Event:</strong> {{ order.event.title }}</p>
        <p><strong>Meal:</strong> {{ order.meal_option.name }}</p>
        <p><strong>Amount:</strong> RM{{ "%.2f"|format(order.amount + order.admin_fee) }}</p>
    </div>

    <a href="{{ url_for('orders.list_orders') }}" class="btn-primary">View My Orders</a>

    {% else %}
    <div class="error-icon">❌</div>
    <h2>Payment Failed</h2>
    <p>Your payment could not be processed.</p>
    <a href="{{ url_for('payment.checkout', event_id=order.event_id, meal_id=order.meal_option_id) }}"
        class="btn-primary">Try Again</a>
    {% endif %}
</div>
{% endblock %}